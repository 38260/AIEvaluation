「通用型AI模型评价工具」
1. 工具核心目标
开发一款Python程序，通过调用外部AI模型的API接口，逐条评估样本数据，自动进行AI评估并计算模型的评估指标（准确率、召回率、混淆矩阵），输出可追溯的评价结果，且所有关键参数支持自定义配置。

2. 适用场景
适用于二分类任务的AI模型效果评价，支持任意可通过API调用的AI模型（如GPT、文心一言、自定义大模型等），样本数据为文本类（content字段）。

3. 输入规范
- 数据输入：单个xlsx文件，必须包含3列核心字段：
  - ID：样本唯一标识（字符串/数字，不可重复）；
  - content：待AI分析的文本内容（字符串，非空）；
  - ground_truth：样本真实标签（字符串/数字，二分类如"是/否"）；
- 配置输入：config.ini配置文件，支持自定义以下参数（必填项标注*）：
  - [API配置]：api_url*（AI接口地址）、api_key*（接口密钥）、temperature（生成温度，默认0）、timeout（请求超时时间，默认30秒）、max_retry（失败重试次数，默认3次）；
  - [Prompt配置]：system_prompt_path（系统提示词文件路径，可选）、user_prompt*（用户提示词模板，支持嵌入{content}变量）；
  - [数据配置]：input_xlsx_path*（输入xlsx路径）、output_xlsx_path*（输出xlsx路径）、label_field（AI返回结果中"标签"的字段名，默认"label"）、reason_field（AI返回结果中"理由"的字段名，默认"reason"）；
  - [评估配置]：task_type（任务类型，"binary"二分类"）、positive_label（二分类正例标签，如"是"，必填）。
4. 核心处理流程（严格按顺序执行）
步骤1：配置加载与校验
- 读取config.ini，校验必填配置项是否存在；
- 校验输入xlsx文件是否存在、核心字段是否完整，若缺失则输出错误日志并终止程序。
步骤2：样本数据读取
- 读取xlsx文件，按ID去重（保留第一条），生成待处理样本列表；
- 打印待处理样本总数、标签分布（如正例N条，负例M条）。
步骤3：AI接口批量调用（逐条执行，支持断点续跑）
- 遍历每个样本，将content字段嵌入user_prompt，结合system_prompt（读取txt）组装成完整prompt；
- 调用AI API接口，传递prompt及API配置参数（temperature/timeout等）；
- 异常处理规则：
  - 接口超时/返回非200状态码：重试max_retry次，仍失败则标记该样本"调用失败"，label/reason填"API调用失败"；
  - AI返回结果缺失label字段：标记"结果解析失败"，label/reason填"无有效标签"；
  - 每处理10条样本，自动保存一次中间结果到临时xlsx，防止数据丢失。
步骤4：结果整合
- 在原xlsx数据基础上，新增2列：
  - label：AI模型输出的预测标签；
  - reason：AI模型输出的判断理由（便于人工复核）；
- 最终结果保存到output_xlsx_path指定路径，包含所有原始字段+新增字段。
步骤5：评估指标计算与输出
- 过滤掉调用失败/解析失败的样本，仅用有效样本计算指标；
- 二分类任务指标：
  - 准确率（Accuracy）= 预测正确样本数 / 有效样本总数；
  - 召回率（Recall）= 真阳性（TP）/ (真阳性TP + 假阴性FN)；
  - 精确率（Precision）= 真阳性（TP）/ (真阳性TP + 假阳性FP)；
  - F1值 = 2*(精确率*召回率)/(精确率+召回率)；
  - 混淆矩阵（2x2）：行=真实标签，列=预测标签，输出数值矩阵+可视化文本；

- 打印汇总结果：样本总数、有效样本数、各指标数值、混淆矩阵，同时将评估报告保存为txt文件。
5. 输出规范
- 最终文件：处理后的xlsx（含所有样本+label/reason）、评估报告txt（含指标+混淆矩阵）；
- 日志输出：实时打印处理进度（如"已处理50/100条样本"）、异常信息（如"样本ID123调用失败，重试3次仍超时"）；
- 格式要求：所有数值指标保留4位小数，混淆矩阵用表格形式打印（如| 真实\预测 | 是 | 否 |）。
6. 约束条件
- 兼容Python 3.8+版本；
- 依赖库优先选择主流库（pandas、requests/aiohttp、configparser、scikit-learn）；
- 支持中文标签，无编码乱码问题；
- 代码需包含注释，关键步骤需有日志输出。
